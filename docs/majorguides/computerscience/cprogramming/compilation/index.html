<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.85.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel="shortcut icon" href=/ucsc-guide/favicons/favicon.ico><link rel=apple-touch-icon href=/ucsc-guide/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/ucsc-guide/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/ucsc-guide/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/ucsc-guide/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/ucsc-guide/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/ucsc-guide/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/ucsc-guide/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/ucsc-guide/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/ucsc-guide/favicons/android-192x192.png sizes=192x192><title>Compilation | Unofficial UCSC Student Guide</title><meta name=description content="Compilation, linking, header files, object files, and Makefiles
"><meta property="og:title" content="Compilation"><meta property="og:description" content="Compilation, linking, header files, object files, and Makefiles
"><meta property="og:type" content="article"><meta property="og:url" content="https://hilalmorrar.com/ucsc-guide/docs/majorguides/computerscience/cprogramming/compilation/"><meta property="article:section" content="docs"><meta property="article:published_time" content="2021-10-12T00:00:00-07:00"><meta property="article:modified_time" content="2021-10-12T00:51:55-07:00"><meta property="og:site_name" content="Unofficial UCSC Student Guide"><meta itemprop=name content="Compilation"><meta itemprop=description content="Compilation, linking, header files, object files, and Makefiles
"><meta itemprop=datePublished content="2021-10-12T00:00:00-07:00"><meta itemprop=dateModified content="2021-10-12T00:51:55-07:00"><meta itemprop=wordCount content="5220"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Compilation"><meta name=twitter:description content="Compilation, linking, header files, object files, and Makefiles
"><link rel=preload href=/ucsc-guide/scss/main.min.c7864c5e11ce29b0d7fb95d2fbbc92f0cd7d92caacfebfa74a46b09df7d22072.css as=style><link href=/ucsc-guide/scss/main.min.c7864c5e11ce29b0d7fb95d2fbbc92f0cd7d92caacfebfa74a46b09df7d22072.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-RLWCTQZNV4"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-RLWCTQZNV4',{anonymize_ip:!1})}</script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/ucsc-guide/><span class=navbar-logo><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="text-uppercase font-weight-bold">Unofficial UCSC Student Guide</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/ucsc-guide/docs/><i class="fas fa-map"></i><span>The Guide</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://github.com/hamorrar/ucsc-guide target=_blank><i class="fab fa-github"></i><span>GitHub</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/ucsc-guide/offline-search-index.48cf4ac2f29d1c535ec53406326a57df.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><script>$(function(){$("#td-section-nav a").removeClass("active"),$("#td-section-nav #m-ucsc-guidedocsmajorguidescomputersciencecprogrammingcompilation").addClass("active"),$("#td-section-nav #m-ucsc-guidedocsmajorguidescomputersciencecprogrammingcompilation-li span").addClass("td-sidebar-nav-active-item"),$("#td-section-nav #m-ucsc-guidedocsmajorguidescomputersciencecprogrammingcompilation").parents("li").addClass("active-path"),$("#td-section-nav li.active-path").addClass("show"),$("#td-section-nav li.active-path").children("input").prop('checked',!0),$("#td-section-nav #m-ucsc-guidedocsmajorguidescomputersciencecprogrammingcompilation-li").siblings("li").addClass("show"),$("#td-section-nav #m-ucsc-guidedocsmajorguidescomputersciencecprogrammingcompilation-li").children("ul").children("li").addClass("show"),$("#td-sidebar-menu").toggleClass("d-none")})</script><div id=td-sidebar-menu class="td-sidebar__inner d-none"><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/ucsc-guide/offline-search-index.48cf4ac2f29d1c535ec53406326a57df.json data-offline-search-base-href=/ data-offline-search-max-results=10>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav foldable-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-ucsc-guidedocs-li><a href=/ucsc-guide/docs/ title="How to Use This Guide" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-ucsc-guidedocs><span>Start Here</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-ucsc-guidedocshousing-li><input type=checkbox id=m-ucsc-guidedocshousing-check>
<label for=m-ucsc-guidedocshousing-check><a href=/ucsc-guide/docs/housing/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-ucsc-guidedocshousing><span>Housing</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-ucsc-guidedocshousingoffcampus-li><input type=checkbox id=m-ucsc-guidedocshousingoffcampus-check>
<label for=m-ucsc-guidedocshousingoffcampus-check><a href=/ucsc-guide/docs/housing/offcampus/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-ucsc-guidedocshousingoffcampus><span>Off Campus Housing</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ucsc-guidedocshousingoffcampushouse_apartment-li><input type=checkbox id=m-ucsc-guidedocshousingoffcampushouse_apartment-check>
<label for=m-ucsc-guidedocshousingoffcampushouse_apartment-check><a href=/ucsc-guide/docs/housing/offcampus/house_apartment/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-ucsc-guidedocshousingoffcampushouse_apartment><span>House/Apartment</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ucsc-guidedocshousingoffcampusutc-li><input type=checkbox id=m-ucsc-guidedocshousingoffcampusutc-check>
<label for=m-ucsc-guidedocshousingoffcampusutc-check><a href=/ucsc-guide/docs/housing/offcampus/utc/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-ucsc-guidedocshousingoffcampusutc><span>University Town Center</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ucsc-guidedocshousingoncampus-li><input type=checkbox id=m-ucsc-guidedocshousingoncampus-check>
<label for=m-ucsc-guidedocshousingoncampus-check><a href=/ucsc-guide/docs/housing/oncampus/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-ucsc-guidedocshousingoncampus><span>On Campus Housing</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-ucsc-guidedocsmajorguides-li><input type=checkbox id=m-ucsc-guidedocsmajorguides-check>
<label for=m-ucsc-guidedocsmajorguides-check><a href=/ucsc-guide/docs/majorguides/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-ucsc-guidedocsmajorguides><span>Major Guides</span></a></label><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-ucsc-guidedocsmajorguidescomputerscience-li><input type=checkbox id=m-ucsc-guidedocsmajorguidescomputerscience-check>
<label for=m-ucsc-guidedocsmajorguidescomputerscience-check><a href=/ucsc-guide/docs/majorguides/computerscience/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-ucsc-guidedocsmajorguidescomputerscience><span>Computer Science</span></a></label><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-ucsc-guidedocsmajorguidescomputersciencecprogramming-li><input type=checkbox id=m-ucsc-guidedocsmajorguidescomputersciencecprogramming-check>
<label for=m-ucsc-guidedocsmajorguidescomputersciencecprogramming-check><a href=/ucsc-guide/docs/majorguides/computerscience/cprogramming/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-ucsc-guidedocsmajorguidescomputersciencecprogramming><span>C Programming</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ucsc-guidedocsmajorguidescomputersciencecprogrammingcompilation-li><input type=checkbox id=m-ucsc-guidedocsmajorguidescomputersciencecprogrammingcompilation-check>
<label for=m-ucsc-guidedocsmajorguidescomputersciencecprogrammingcompilation-check><a href=/ucsc-guide/docs/majorguides/computerscience/cprogramming/compilation/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-ucsc-guidedocsmajorguidescomputersciencecprogrammingcompilation><span>Compilation</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-ucsc-guidedocsmajorguidescomputersciencediscretemath-li><input type=checkbox id=m-ucsc-guidedocsmajorguidescomputersciencediscretemath-check>
<label for=m-ucsc-guidedocsmajorguidescomputersciencediscretemath-check><a href=/ucsc-guide/docs/majorguides/computerscience/discretemath/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-ucsc-guidedocsmajorguidescomputersciencediscretemath><span>Discrete Math</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ucsc-guidedocsmajorguidescomputersciencediscretemathproofs-li><input type=checkbox id=m-ucsc-guidedocsmajorguidescomputersciencediscretemathproofs-check>
<label for=m-ucsc-guidedocsmajorguidescomputersciencediscretemathproofs-check><a href=/ucsc-guide/docs/majorguides/computerscience/discretemath/proofs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-ucsc-guidedocsmajorguidescomputersciencediscretemathproofs><span>Proofs</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ucsc-guidedocsmajorguidescomputersciencediscretemathlogic-li><input type=checkbox id=m-ucsc-guidedocsmajorguidescomputersciencediscretemathlogic-check>
<label for=m-ucsc-guidedocsmajorguidescomputersciencediscretemathlogic-check><a href=/ucsc-guide/docs/majorguides/computerscience/discretemath/logic/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-ucsc-guidedocsmajorguidescomputersciencediscretemathlogic><span>Logic</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ucsc-guidedocsmajorguidescomputersciencediscretemathsettheory-li><input type=checkbox id=m-ucsc-guidedocsmajorguidescomputersciencediscretemathsettheory-check>
<label for=m-ucsc-guidedocsmajorguidescomputersciencediscretemathsettheory-check><a href=/ucsc-guide/docs/majorguides/computerscience/discretemath/settheory/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-ucsc-guidedocsmajorguidescomputersciencediscretemathsettheory><span>Set Theory</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ucsc-guidedocsmajorguidescomputersciencemachinelearning-li><input type=checkbox id=m-ucsc-guidedocsmajorguidescomputersciencemachinelearning-check>
<label for=m-ucsc-guidedocsmajorguidescomputersciencemachinelearning-check><a href=/ucsc-guide/docs/majorguides/computerscience/machinelearning/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-ucsc-guidedocsmajorguidescomputersciencemachinelearning><span>Intro to Machine Learning</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-ucsc-guidedocsmajorguidescomputersciencegit-li><input type=checkbox id=m-ucsc-guidedocsmajorguidescomputersciencegit-check>
<label for=m-ucsc-guidedocsmajorguidescomputersciencegit-check><a href=/ucsc-guide/docs/majorguides/computerscience/git/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-ucsc-guidedocsmajorguidescomputersciencegit><span>Git</span></a></label><ul class="ul-4 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-ucsc-guidedocsmajorguidescomputersciencegitbasics-li><input type=checkbox id=m-ucsc-guidedocsmajorguidescomputersciencegitbasics-check>
<label for=m-ucsc-guidedocsmajorguidescomputersciencegitbasics-check><a href=/ucsc-guide/docs/majorguides/computerscience/git/basics/ title="Git Basics" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-ucsc-guidedocsmajorguidescomputersciencegitbasics><span>Basics</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ucsc-guidedocsmajorguidescomputersciencegitbasicsbasic_git_operations-li><input type=checkbox id=m-ucsc-guidedocsmajorguidescomputersciencegitbasicsbasic_git_operations-check>
<label for=m-ucsc-guidedocsmajorguidescomputersciencegitbasicsbasic_git_operations-check><a href=/ucsc-guide/docs/majorguides/computerscience/git/basics/basic_git_operations/ title="Basic Git Operations" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-ucsc-guidedocsmajorguidescomputersciencegitbasicsbasic_git_operations><span>Basic Operations</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-ucsc-guidedocsmajorguidescomputersciencegitfundamentals-li><input type=checkbox id=m-ucsc-guidedocsmajorguidescomputersciencegitfundamentals-check>
<label for=m-ucsc-guidedocsmajorguidescomputersciencegitfundamentals-check><a href=/ucsc-guide/docs/majorguides/computerscience/git/fundamentals/ title="Git Fundamentals" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-ucsc-guidedocsmajorguidescomputersciencegitfundamentals><span>Fundamentals</span></a></label><ul class="ul-5 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ucsc-guidedocsmajorguidescomputersciencegitfundamentalswhat_is_version_control-li><input type=checkbox id=m-ucsc-guidedocsmajorguidescomputersciencegitfundamentalswhat_is_version_control-check>
<label for=m-ucsc-guidedocsmajorguidescomputersciencegitfundamentalswhat_is_version_control-check><a href=/ucsc-guide/docs/majorguides/computerscience/git/fundamentals/what_is_version_control/ title="What Is Version Control?" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-ucsc-guidedocsmajorguidescomputersciencegitfundamentalswhat_is_version_control><span>What is version control?</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ucsc-guidedocsmajorguidescomputersciencegitfundamentalshow_git_works-li><input type=checkbox id=m-ucsc-guidedocsmajorguidescomputersciencegitfundamentalshow_git_works-check>
<label for=m-ucsc-guidedocsmajorguidescomputersciencegitfundamentalshow_git_works-check><a href=/ucsc-guide/docs/majorguides/computerscience/git/fundamentals/how_git_works/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-ucsc-guidedocsmajorguidescomputersciencegitfundamentalshow_git_works><span>How Git Works</span></a></label></li></ul></li></ul></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-ucsc-guidedocscontribution_guidelines-li><input type=checkbox id=m-ucsc-guidedocscontribution_guidelines-check>
<label for=m-ucsc-guidedocscontribution_guidelines-check><a href=/ucsc-guide/docs/contribution_guidelines/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-ucsc-guidedocscontribution_guidelines><span>Contribution Guidelines</span></a></label></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class=td-toc><nav id=TableOfContents><ul><li><a href=#our-program>Our program</a></li><li><a href=#using-the-math-library>Using the math library</a><ul><li><a href=#header-files>Header files</a></li><li><a href=#linking-against-a-system-library>Linking against a system library</a></li></ul></li><li><a href=#splitting-up-our-program>Splitting up our program</a></li><li><a href=#automating-compilation-with-make>Automating compilation with Make</a><ul><li><a href=#object-files>Object files</a></li><li><a href=#manually-compiling-and-linking>Manually compiling and linking</a></li><li><a href=#make>Make</a></li><li><a href=#a-more-advanced-makefile>A more advanced Makefile</a></li></ul></li><li><a href=#expanding-our-program>Expanding our program</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://hilalmorrar.com/ucsc-guide/docs/>Start Here</a></li><li class=breadcrumb-item><a href=https://hilalmorrar.com/ucsc-guide/docs/majorguides/>Major Guides</a></li><li class=breadcrumb-item><a href=https://hilalmorrar.com/ucsc-guide/docs/majorguides/computerscience/>Computer Science</a></li><li class=breadcrumb-item><a href=https://hilalmorrar.com/ucsc-guide/docs/majorguides/computerscience/cprogramming/>C Programming</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://hilalmorrar.com/ucsc-guide/docs/majorguides/computerscience/cprogramming/compilation/>Compilation</a></li></ol></nav><div class=td-content><h1>Compilation</h1><div class=lead>Compilation, linking, header files, object files, and Makefiles</div><div class="td-byline mb-4">By <b>Ben Grant</b> |
<time datetime=2021-10-12 class=text-muted>Tuesday, October 12, 2021</time></div><header class=article-meta></header><p>This page describes how to compile C programs that are more complex than a single source file. We&rsquo;ll cover how to split code across multiple files, how to compile those files, how to automate the build process using GNU Make, and how to make use of system libraries.</p><p>You can follow along with this guide on your own computer. All you&rsquo;ll need is familiarity with the command line and a C programming environment with recent versions of Clang and Make. I would recommend using Linux (either running on your computer, in a virtual machine, or in WSL2). These commands may also work on macOS if you install Clang and Make, but they will <em>not</em> work on Windows if you don&rsquo;t have a Linux environment.</p><h2 id=our-program>Our program</h2><p>To get started, create an empty directory to hold all the files that we create. The name doesn&rsquo;t matter. Navigate into that directory and create the following C file called <code>hypot.c</code>. This is the program that we will be working with. Given two side lengths of a right triangle, it calculates the length of the hypotenuse.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#8f5902;font-style:italic>// hypot.c
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;stdio.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;stdlib.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#8f5902;font-style:italic>// approximation of sqrt(x) for some values of x
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#204a87;font-weight:700>unsigned</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>sqrts</span><span style=color:#000;font-weight:700>[]</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>3</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>4</span><span style=color:#000;font-weight:700>,</span>
    <span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span> <span style=color:#0000cf;font-weight:700>5</span><span style=color:#000;font-weight:700>,</span>
<span style=color:#000;font-weight:700>};</span>

<span style=color:#204a87;font-weight:700>unsigned</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>my_sqrt</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>unsigned</span> <span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#000>x</span> <span style=color:#ce5c00;font-weight:700>&gt;</span> <span style=color:#0000cf;font-weight:700>25</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>fprintf</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>stderr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;error: cannot take sqrt of %u</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>);</span>
        <span style=color:#000>exit</span><span style=color:#000;font-weight:700>(</span><span style=color:#0000cf;font-weight:700>2</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>sqrts</span><span style=color:#000;font-weight:700>[</span><span style=color:#000>x</span><span style=color:#000;font-weight:700>];</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>my_hypot</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>my_sqrt</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>a</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>a</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>b</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>void</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;side a: &#34;</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>scanf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%lf&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>a</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>fprintf</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>stderr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;invalid input</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;side b: &#34;</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>scanf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%lf&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>b</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>fprintf</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>stderr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;invalid input</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span>

    <span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;c = %lf</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>my_hypot</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>));</span>
    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><p>You may already know the command to compile this using Clang:</p><pre><code>$ clang -Wall -Werror -Wextra -Wpedantic -o hypot hypot.c
</code></pre><p>But what does every part of this mean? Clang, like most command line programs, lets you specify <em>input files</em> (in this case, C files to compile) as well as <em>flags</em> that modify its behavior. Each argument that isn&rsquo;t part of a flag is interpreted as an input file. Let&rsquo;s break down all the arguments:</p><ul><li><code>-Wall</code>, <code>-Werror</code>, <code>-Wextra</code>, <code>-Wpedantic</code>: each of these enables a certain class of warnings. Together, they make Clang very strict. With these flags, compilation will often fail when issues are encountered that would normally only be treated as warnings.</li><li><code>-o</code>, <code>hypot</code>: the <code>o</code> stands for &ldquo;output,&rdquo; and means that the next argument should be used as the output filename. This makes Clang save the executable file as <code>hypot</code>, and prevents <code>hypot</code> from being interpreted as an input filename.</li><li><code>hypot.c</code>: this is the only input file.</li></ul><p>The compilation should succeed without errors. Now you can run the program:</p><pre><code>$ ./hypot
side a: 3
side b: 4
c = 5.000000
</code></pre><p>It worked! But, as you might have noticed from the code, our calculation is extremely limited—the square root function only returns integer approximations for numbers between 0 and 25, and fails on any other numbers. Here&rsquo;s an example:</p><pre><code>$ ./hypot
side a: 2
side b: 2
c = 3.000000
</code></pre><p>The side length should be √8 ≈ 2.828. We&rsquo;re going to modify this program to:</p><ul><li>use the built-in math library&rsquo;s <code>sqrt</code> function</li><li>move the <code>my_hypot</code> function into another file</li><li>automatically compile with all the right parameters when we run <code>make</code></li></ul><h2 id=using-the-math-library>Using the math library</h2><p>You may know that in order to call math functions like <code>sqrt</code>, you need to do two things: put <code>#include &lt;math.h></code> at the top of your file, and add <code>-lm</code> to your compilation flags. What do these do?</p><h3 id=header-files>Header files</h3><p>Including a file with <code>#include</code> inserts its contents at the position of the <code>#include</code> statement, nothing more. Since <code>&lt;math.h></code> uses angle brackets instead of quotes, the preprocessor (which is responsible for processing includes, among other things) looks for a file in the <em>include path</em>, instead of the current directory. You can modify the include path, but the default (on Linux, at least) is <code>/usr/include</code>. This means that we are including <code>/usr/include/math.h</code>, a file that comes with the operating system. You can actually open and view this file! Sadly, it is full of macros and includes other files, so the actual declaration of <code>sqrt</code> is not easy to find, but you can imagine that somewhere in that file is the declaration:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>sqrt</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>x</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><p>(Since the preprocessor processes includes recursively, as far as you are concerned, that declaration may as well actually be in <code>/usr/include/math.h</code>. The fact that it isn&rsquo;t is transparent to you.)</p><p>Let&rsquo;s change our program to use the system&rsquo;s <code>sqrt</code> function (to make this tutorial easier to follow, when you modify a file, I&rsquo;ll specify what the complete contents should now be):</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#8f5902;font-style:italic>// hypot.c
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;stdio.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;stdlib.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#8f5902;font-style:italic>// new line
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;math.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#8f5902;font-style:italic>// deleted: sqrts array and my_sqrt function
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>my_hypot</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#8f5902;font-style:italic>// modified
</span><span style=color:#8f5902;font-style:italic></span>    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>sqrt</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>a</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>a</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>b</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>void</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;side a: &#34;</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>scanf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%lf&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>a</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>fprintf</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>stderr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;invalid input</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;side b: &#34;</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>scanf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%lf&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>b</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>fprintf</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>stderr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;invalid input</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span>

    <span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;c = %lf</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>my_hypot</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>));</span>
    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><h3 id=linking-against-a-system-library>Linking against a system library</h3><p>Let&rsquo;s recompile:</p><pre><code>$ clang -Wall -Wextra -Werror -Wpedantic hypot.c -o hypot
/usr/bin/ld: /tmp/hypot-1e886c.o: in function `my_hypot':
hypot.c:(.text+0x2b): undefined reference to `sqrt'
clang-12: error: linker command failed with exit code 1 (use -v to see invocation)
</code></pre><p>Uh oh! The important part of this error is <code>undefined reference to `sqrt'</code>. Remember that <code>math.h</code> contains only the declaration of <code>sqrt</code>. That essentially tells the compiler that there <em>will be</em> a function available, called <code>sqrt</code>, returning a <code>double</code>, and taking one <code>double</code> as its argument. However, to finish linking the binary, the linker needs to know what the address of that function will be at runtime, so that it can insert the proper function call. (We&rsquo;ll get into the difference between compiling and linking later. For now, know that <code>clang -Wall -Wextra -Werror -Wpedantic hypot.c -o hypot</code> runs both steps, compiling and then linking your C file).</p><p>We can fix this error by <em>linking against</em> the math library. This is a <em>shared library</em>, meaning that its code can be used by any program on your computer, and the code is loaded dynamically when the program runs instead of being part of the executable. (All modern operating systems have shared libraries, but they use different file extensions. On Linux they are <code>.so</code> files, macOS uses <code>.dylib</code>, and Windows uses <code>.dll</code>.) Each executable contains a list of shared libraries that should be loaded, and linking against a shared library just adds its name to this list.</p><p>Library names are prefixed with <code>lib</code>. The math library is <code>libm</code>. To link against a library, you use <code>-l</code> followed by the name of the library without the prefix, so the math library is <code>-lm</code>. Let&rsquo;s recompile with this flag:</p><pre><code>$ clang -Wall -Wextra -Werror -Wpedantic hypot.c -o hypot -lm
</code></pre><p>This time, the program handles the entire range of square roots:</p><pre><code>$ ./hypot
side a: 2
side b: 2
c = 2.828427
</code></pre><p>Besides the fact that compilation succeeded, how do we know that the math library was linked properly? There&rsquo;s a utility called <code>ldd</code> that lists which libraries a given executable links against. Let&rsquo;s try it on our <code>hypot</code> binary:</p><pre><code>$ ldd hypot
        linux-vdso.so.1 (0x00007ffdc0912000)
        libm.so.6 =&gt; /usr/lib/libm.so.6 (0x00007fa15dbbd000)
        libc.so.6 =&gt; /usr/lib/libc.so.6 (0x00007fa15d9f1000)
        /lib64/ld-linux-x86-64.so.2 =&gt; /usr/lib64/ld-linux-x86-64.so.2 (0x00007fa15dd43000)
</code></pre><p>The exact output may differ from system to system, but you should at least see <code>libm</code> and <code>libc</code>. <code>libc</code> is the standard C library, and it is linked by default. That&rsquo;s why we can call functions like <code>printf</code> and <code>scanf</code> without any linker flags—they are part of <code>libc</code>.</p><p>Another interesting thing about this output is that it shows where each library is stored. On my system, they are all in <code>/usr/lib</code>. I tried this on an Ubuntu system and they were in <code>/lib/x86_64-linux-gnu</code> (suggesting that you could also have dynamic libraries installed for different CPU architectures). Fortunately, the system determines the exact path when your executable is running. This means I could copy my <code>hypot</code> executable onto an Ubuntu system (or copy an executable compiled on Ubuntu onto my system), and it would still find all the libraries it needs.</p><h2 id=splitting-up-our-program>Splitting up our program</h2><p>We have successfully modified our program to use the system&rsquo;s <code>sqrt</code> function instead of our own janky one! All that remains is to, as promised, move the <code>my_hypot</code> function into its own file.</p><p>We&rsquo;ll create two new files: a header, <code>mathlib.h</code>, and a C file, <code>mathlib.c</code>. Insert the following contents:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#8f5902;font-style:italic>// mathlib.h
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#8f5902;font-style:italic>#pragma once
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>my_hypot</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>);</span>
</code></pre></div><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#8f5902;font-style:italic>// mathlib.c
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&#34;mathlib.h&#34;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;math.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>my_hypot</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>sqrt</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>a</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>a</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>b</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><p>The line <code>#pragma once</code> in <code>mathlib.h</code> ensures that the header file is only included once. It won&rsquo;t make a difference in this tutorial, but in more advanced programs where one header file includes another header file (e.g. to get type definitions), you may get errors about multiple definitions of the contents of a header without <code>#pragma once</code>.</p><p>We also need to include the header file (not the C file!) from our main <code>hypot.c</code>. Add the <code>#include</code> statement:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#8f5902;font-style:italic>// hypot.c
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;stdio.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;stdlib.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;math.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#8f5902;font-style:italic>// new line
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&#34;mathlib.h&#34;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>my_hypot</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#000>sqrt</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>a</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>a</span> <span style=color:#ce5c00;font-weight:700>+</span> <span style=color:#000>b</span> <span style=color:#ce5c00;font-weight:700>*</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>);</span>
<span style=color:#000;font-weight:700>}</span>

<span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>void</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;side a: &#34;</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>scanf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%lf&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>a</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>fprintf</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>stderr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;invalid input</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;side b: &#34;</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>scanf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%lf&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>b</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>fprintf</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>stderr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;invalid input</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span>

    <span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;c = %lf</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>my_hypot</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>));</span>
    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><p>We <code>#include</code> headers, not C files, because the C file is going to be compiled separately and linked. The file with the include statement only needs the declarations of functions, not definitions.</p><p>You may already be thinking of some other changes we&rsquo;ll have to make to <code>hypot.c</code>. Let&rsquo;s add <code>mathlib.c</code> as an input file to our last compilation command, and try compiling this:</p><pre><code>$ clang -Wall -Wextra -Werror -Wpedantic hypot.c mathlib.c -o hypot -lm
/usr/bin/ld: /tmp/mathlib-5b7ded.o: in function `my_hypot':
mathlib.c:(.text+0x0): multiple definition of `my_hypot'; /tmp/hypot-96432d.o:hypot.c:(.text+0x0): first defined here
clang-12: error: linker command failed with exit code 1 (use -v to see invocation)
</code></pre><p>Zeroing in on that error, the main issue is <code>multiple definition of `my_hypot'</code>. It says that one definition is in <code>mathlib.c</code> and another is in <code>hypot.c</code>. Let&rsquo;s remove the one in <code>hypot.c</code> (we also remove <code>#include &lt;math.h></code> since this file no longer needs to call <code>sqrt</code>):</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;stdio.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;stdlib.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&#34;mathlib.h&#34;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#8f5902;font-style:italic>// my_hypot function removed
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>void</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;side a: &#34;</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>scanf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%lf&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>a</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>fprintf</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>stderr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;invalid input</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;side b: &#34;</span><span style=color:#000;font-weight:700>);</span>
    <span style=color:#204a87;font-weight:700>if</span> <span style=color:#000;font-weight:700>(</span><span style=color:#ce5c00;font-weight:700>!</span><span style=color:#000>scanf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;%lf&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#ce5c00;font-weight:700>&amp;</span><span style=color:#000>b</span><span style=color:#000;font-weight:700>))</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#000>fprintf</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>stderr</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;invalid input</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>);</span>
        <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>1</span><span style=color:#000;font-weight:700>;</span>
    <span style=color:#000;font-weight:700>}</span>

    <span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;c = %lf</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>my_hypot</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>));</span>
    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#000;font-weight:700>}</span>
</code></pre></div><p>If we compile this using the same command as before, it works!</p><h2 id=automating-compilation-with-make>Automating compilation with Make</h2><p>We&rsquo;re almost ready to reduce our entire compilation process to just one command, but first we must learn one more concept.</p><h3 id=object-files>Object files</h3><p>An executable file (like the <code>hypot</code> file that we are creating) contains several things:</p><ul><li>machine code for every function in your program</li><li>an entry point (in C, the <code>main</code> function) where execution should begin</li><li>data that the program will need when it runs (e.g. the <code>"side a: "</code>) string that we print</li><li>space for global variables</li><li>a list of dynamic libraries that should be loaded</li></ul><p>An <em>object file</em> is similar to an executable, but different in some important ways. At the fundamental level, object files still contain executable code. An executable file is your whole program, but for programs with multiple source files, an object file is the compiled version of a single C file. Since object files cannot run on their own, they don&rsquo;t have an entry point (they could have a function called <code>main</code>, however). Also, in an executable file, every function that&rsquo;s referenced must be defined either in the executable itself, or in a dynamic library that is linked. Object files can reference external functions.</p><p>To compile a C program, you <em>compile</em> each C file into an object file, and then <em>link</em> those object files into one executable. Even if you don&rsquo;t list these steps explicitly, Clang still performs both steps; it just deletes the object files when it&rsquo;s done. The linking process entails:</p><ul><li>combining all the code in the various object files, making sure there are no functions with the same name</li><li>for each function call, figuring out where that function will actually be located (in the binary or in a dynamic library) at runtime</li><li>making sure there is a <code>main</code> function, and marking it as the entry point</li><li>producing the final binary</li></ul><h3 id=manually-compiling-and-linking>Manually compiling and linking</h3><p>First, let&rsquo;s run the commands to compile our C files to object files and link them. This is what make will eventually do for us.</p><p>The <code>-c</code> flag tells Clang to output an object file instead of an executable. By default, it will just replace <code>.c</code> with <code>.o</code>, but you can also specify the location of the object file manually with <code>-o</code>. Delete the <code>hypot</code> binary if you still have it from a previous section, and then let&rsquo;s compile <code>hypot.c</code> and see what it creates:</p><pre><code>$ clang -Wall -Wextra -Werror -Wpedantic -c hypot.c
$ ls
hypot.c  hypot.o  mathlib.c  mathlib.h
</code></pre><p>Even though <code>hypot.c</code> uses functions from <code>mathlib.c</code>, it compiles just fine. But let&rsquo;s try linking it. The command to link object files is the same as the command to link C files, except you specify object files as input. We also omit the warning flags, since those only affect the compiler, not the linker.</p><pre><code>$ clang hypot.o -o hypot
/usr/bin/ld: hypot.o: in function `main':
hypot.c:(.text+0xc1): undefined reference to `my_hypot'
clang-12: error: linker command failed with exit code 1 (use -v to see invocation)
</code></pre><p>It&rsquo;s complaining that it can&rsquo;t find the <code>my_hypot</code> function, since that is in a different file. Note that we got this error during linking and not compilation, since object files are allowed to reference functions from other files. Let&rsquo;s compile <code>mathlib.c</code> into an object file and try again:</p><pre><code>$ clang -Wall -Wextra -Werror -Wpedantic -c mathlib.c
$ ls
hypot.c  hypot.o  mathlib.c  mathlib.h  mathlib.o
$ clang hypot.o mathlib.o -o hypot
/usr/bin/ld: mathlib.o: in function `my_hypot':
mathlib.c:(.text+0x2b): undefined reference to `sqrt'
clang-12: error: linker command failed with exit code 1 (use -v to see invocation)
</code></pre><p>Now it can find <code>my_hypot</code>, but it still can&rsquo;t find <code>sqrt</code> since we aren&rsquo;t linking the math library. We can add the <code>-lm</code> flag the same way as before:</p><pre><code>$ clang -lm hypot.o mathlib.o -o hypot
$ ls
hypot  hypot.c  hypot.o  mathlib.c  mathlib.h  mathlib.o
</code></pre><p>It worked!</p><p>Currently, after changing our code, we would have to:</p><ul><li>recompile any C file(s) that we changed into new object files</li><li>link all our object files (including ones that didn&rsquo;t change) into a new binary</li></ul><p>This will become impractical quickly. <a href=https://xkcd.com/1319/>Let&rsquo;s automate it!</a></p><h3 id=make>Make</h3><p>Make is a utility to automate your build process. It reads a Makefile (which is just a text file exactly called <code>Makefile</code>) for instructions on how to produce various files, and builds the one that you specified.</p><p>The true power of Make lies in its dependency system. You can specify the files that a file depends on (for instance, our binary <code>hypot</code> depends on the object files <code>hypot.o</code> and <code>mathlib.o</code>). When you use Make to build one file, it will automatically build all the file&rsquo;s dependencies. But it will also look at when the various files were modified, and avoid rebuilding dependencies that have not changed since the file that depends on them was rebuilt. In our example, this means that if we run <code>make</code>, change <code>hypot.c</code>, and run <code>make</code> again, it won&rsquo;t bother recompiling <code>mathlib.c</code>. This saves a lot of time for large programs!</p><p>We&rsquo;re going to build up our Makefile a little bit at a time. Create a file called <code>Makefile</code> with the following contents:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=color:#000>CC</span> <span style=color:#ce5c00;font-weight:700>=</span> clang
<span style=color:#000>CFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -Wall -Wextra -Werror -Wpedantic
<span style=color:#000>LDFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -lm
<span style=color:#000>EXEC</span> <span style=color:#ce5c00;font-weight:700>=</span> hypot
<span style=color:#000>OBJS</span> <span style=color:#ce5c00;font-weight:700>=</span> hypot.o mathlib.o
</code></pre></div><p>These are variables that we&rsquo;ll use later in the Makefile.</p><ul><li><code>CC</code> is the name of the C compiler that we use</li><li><code>CFLAGS</code> are the flags that are passed to the compiler</li><li><code>LDFLAGS</code> are the flags that are passed to the linker</li><li><code>EXEC</code> is the name of the executable file we are making</li><li><code>OBJS</code> is the list of object files that we want to compile and link</li></ul><p>Let&rsquo;s add the next parts to our Makefile:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=color:#000>CC</span> <span style=color:#ce5c00;font-weight:700>=</span> clang
<span style=color:#000>CFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -Wall -Wextra -Werror -Wpedantic
<span style=color:#000>LDFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -lm
<span style=color:#000>EXEC</span> <span style=color:#ce5c00;font-weight:700>=</span> hypot
<span style=color:#000>OBJS</span> <span style=color:#ce5c00;font-weight:700>=</span> hypot.o mathlib.o

<span style=color:#000>$(EXEC)</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>$(</span><span style=color:#000>OBJS</span><span style=color:#204a87;font-weight:700>)</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>LDFLAGS<span style=color:#204a87;font-weight:700>)</span> -o <span style=color:#204a87;font-weight:700>$(</span>EXEC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>OBJS<span style=color:#204a87;font-weight:700>)</span>
</code></pre></div><p>Make sure the last line is indented with tabs, not spaces. Make requires tabs.</p><p>This looks complicated! The main thing going on is that <code>$(VAR)</code> gets replaced with the variable <code>VAR</code>. If we perform those replacements manually, those last two lines look like:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=color:#000>hypot</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>hypot</span>.<span style=color:#000>o</span> <span style=color:#000>mathlib</span>.<span style=color:#000>o</span>
	clang -lm -o hypot hypot.o mathlib.o
</code></pre></div><p>This is one <em>target</em>. A target begins with the line <code>target: dependencies</code>, so in this case we are saying that <code>hypot</code> is a target which depends on <code>hypot.o</code> and <code>mathlib.o</code>. After this line come the command(s) to build that file, indented with tabs. You can see that, after all the variables have been substituted, the command here is the same as we were already using to link the executable.</p><p>Let&rsquo;s keep going! Next we&rsquo;ll add targets to build our object files:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=color:#000>CC</span> <span style=color:#ce5c00;font-weight:700>=</span> clang
<span style=color:#000>CFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -Wall -Wextra -Werror -Wpedantic
<span style=color:#000>LDFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -lm
<span style=color:#000>EXEC</span> <span style=color:#ce5c00;font-weight:700>=</span> hypot
<span style=color:#000>OBJS</span> <span style=color:#ce5c00;font-weight:700>=</span> hypot.o mathlib.o

<span style=color:#000>$(EXEC)</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>$(</span><span style=color:#000>OBJS</span><span style=color:#204a87;font-weight:700>)</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>LDFLAGS<span style=color:#204a87;font-weight:700>)</span> -o <span style=color:#204a87;font-weight:700>$(</span>EXEC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>OBJS<span style=color:#204a87;font-weight:700>)</span>

<span style=color:#000>hypot.o</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>hypot</span>.<span style=color:#000>c</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>CFLAGS<span style=color:#204a87;font-weight:700>)</span> -c hypot.c

<span style=color:#000>mathlib.o</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>mathlib</span>.<span style=color:#000>c</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>CFLAGS<span style=color:#204a87;font-weight:700>)</span> -c mathlib.c
</code></pre></div><p>We list the C files as dependencies of these targets to ensure that each object file gets rebuilt when its corresponding C file changes. But unlike the previous example, the C files will not get their own targets in the Makefile, since those files are created by us and not Make. Since Make knows it isn&rsquo;t responsible for creating the C files, it will just check that each one exists before it tries to build the object file, and throw an error if one is missing.</p><p>We&rsquo;re going to add some more to the Makefile, but this is already enough to build our program! Let&rsquo;s try it out. To build a Make target, just run <code>make &lt;target name></code> in the directory containing the Makefile. If you don&rsquo;t specify a target, it will use the first one that is defined. In our Makefile, that is the <code>$(EXEC)</code> rule, so we are good to go. Make sure to delete your object files and executable, if you still have them from previous sections.</p><pre><code>$ ls
hypot  hypot.c  hypot.o  Makefile  mathlib.c  mathlib.h  mathlib.o
$ rm hypot *.o
$ ls
hypot.c  Makefile  mathlib.c  mathlib.h
$ make
clang -Wall -Wextra -Werror -Wpedantic -c hypot.c
clang -Wall -Wextra -Werror -Wpedantic -c mathlib.c
clang -lm -o hypot hypot.o mathlib.o
$ ls
hypot  hypot.c  hypot.o  Makefile  mathlib.c  mathlib.h  mathlib.o
$ ./hypot
side a: 2
side b: 3
c = 3.605551
</code></pre><p>It worked! Note how Make prints out the commands that it runs. Let&rsquo;s try compiling it again:</p><pre><code>$ make
make: 'hypot' is up to date.
</code></pre><p>It didn&rsquo;t recompile because it has already built everything that it needs, and we didn&rsquo;t change our C files.</p><h3 id=a-more-advanced-makefile>A more advanced Makefile</h3><p>This Makefile works fine, but it can do more. We&rsquo;re going to make a few changes.</p><h4 id=separate-all-target>Separate <code>all</code> target</h4><p>In a more advanced project, you might have multiple executable files that should be compiled. Right now, we couldn&rsquo;t run <code>make</code> to compile multiple executables, because it only runs the first target by default.</p><p>We can use something called a <em>phony target</em> to remedy this. A phony target is a target that doesn&rsquo;t correspond to a single file. In this case, we create a target called <code>all</code> with all our executables (there is still only one, but there could be more) as dependencies, and put it first in the Makefile:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=color:#000>CC</span> <span style=color:#ce5c00;font-weight:700>=</span> clang
<span style=color:#000>CFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -Wall -Wextra -Werror -Wpedantic
<span style=color:#000>LDFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -lm
<span style=color:#000>EXEC</span> <span style=color:#ce5c00;font-weight:700>=</span> hypot
<span style=color:#000>OBJS</span> <span style=color:#ce5c00;font-weight:700>=</span> hypot.o mathlib.o

<span style=color:#000>all</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>$(</span><span style=color:#000>EXEC</span><span style=color:#204a87;font-weight:700>)</span>

<span style=color:#000>$(EXEC)</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>$(</span><span style=color:#000>OBJS</span><span style=color:#204a87;font-weight:700>)</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>LDFLAGS<span style=color:#204a87;font-weight:700>)</span> -o <span style=color:#204a87;font-weight:700>$(</span>EXEC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>OBJS<span style=color:#204a87;font-weight:700>)</span>

<span style=color:#000>hypot.o</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>hypot</span>.<span style=color:#000>c</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>CFLAGS<span style=color:#204a87;font-weight:700>)</span> -c hypot.c

<span style=color:#000>mathlib.o</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>mathlib</span>.<span style=color:#000>c</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>CFLAGS<span style=color:#204a87;font-weight:700>)</span> -c mathlib.c
</code></pre></div><p>We&rsquo;ve listed <code>hypot</code> as the sole dependency of the <code>all</code> target. If there were a file called <code>all</code> in our project, we would need to name this target something else, because Make would think that it had already been built. Note that there are no commands to build <code>all</code>, because it will still run the commands to build <code>hypot</code>. Feel free to try deleting the executable and/or object files and running <code>make</code> again.</p><h4 id=cleanup>Cleanup</h4><p>It&rsquo;s common to include a target called <code>clean</code> that deletes all executables and object files. We&rsquo;ll do this using <code>rm</code> with the <code>-f</code> flag (&ldquo;force&rdquo;). The flag means that if we ask it to delete a file that doesn&rsquo;t exist, it will silently ignore that argument instead of producing an error, so we can still run our <code>clean</code> target even if there isn&rsquo;t anything for it to delete.</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=color:#000>CC</span> <span style=color:#ce5c00;font-weight:700>=</span> clang
<span style=color:#000>CFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -Wall -Wextra -Werror -Wpedantic
<span style=color:#000>LDFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -lm
<span style=color:#000>EXEC</span> <span style=color:#ce5c00;font-weight:700>=</span> hypot
<span style=color:#000>OBJS</span> <span style=color:#ce5c00;font-weight:700>=</span> hypot.o mathlib.o

<span style=color:#000>all</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>$(</span><span style=color:#000>EXEC</span><span style=color:#204a87;font-weight:700>)</span>

<span style=color:#000>$(EXEC)</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>$(</span><span style=color:#000>OBJS</span><span style=color:#204a87;font-weight:700>)</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>LDFLAGS<span style=color:#204a87;font-weight:700>)</span> -o <span style=color:#204a87;font-weight:700>$(</span>EXEC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>OBJS<span style=color:#204a87;font-weight:700>)</span>

<span style=color:#000>hypot.o</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>hypot</span>.<span style=color:#000>c</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>CFLAGS<span style=color:#204a87;font-weight:700>)</span> -c hypot.c

<span style=color:#000>mathlib.o</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>mathlib</span>.<span style=color:#000>c</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>CFLAGS<span style=color:#204a87;font-weight:700>)</span> -c mathlib.c

<span style=color:#000>clean</span><span style=color:#ce5c00;font-weight:700>:</span>
	rm -f <span style=color:#204a87;font-weight:700>$(</span>EXEC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>OBJS<span style=color:#204a87;font-weight:700>)</span>
</code></pre></div><p><code>clean</code> has no dependencies, and the command uses our variables to delete the files that it should. Let&rsquo;s try it, first using <code>make</code> to make sure our program is compiled.</p><pre><code>$ make
make: Nothing to be done for 'all'.
$ ls
hypot  hypot.c  hypot.o  Makefile  mathlib.c  mathlib.h  mathlib.o
$ make clean
rm -f hypot hypot.o mathlib.o
$ ls
hypot.c  Makefile  mathlib.c  mathlib.h
</code></pre><h4 id=automatically-compiling-object-files>Automatically compiling object files</h4><p>Right now, if we added another C file to our program, we&rsquo;d have to add a new target to our Makefile and copy the command to compile it. This can get unwieldy, and we run the risk of introducing a subtle bug by copying the command incorrectly.</p><p>Fortunately, Make allows us to specify much more general rules. Specifically, we can tell it how to compile any object file from the corresponding C file:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=color:#000>CC</span> <span style=color:#ce5c00;font-weight:700>=</span> clang
<span style=color:#000>CFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -Wall -Wextra -Werror -Wpedantic
<span style=color:#000>LDFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -lm
<span style=color:#000>EXEC</span> <span style=color:#ce5c00;font-weight:700>=</span> hypot
<span style=color:#000>OBJS</span> <span style=color:#ce5c00;font-weight:700>=</span> hypot.o mathlib.o

<span style=color:#000>all</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>$(</span><span style=color:#000>EXEC</span><span style=color:#204a87;font-weight:700>)</span>

<span style=color:#000>$(EXEC)</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>$(</span><span style=color:#000>OBJS</span><span style=color:#204a87;font-weight:700>)</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>LDFLAGS<span style=color:#204a87;font-weight:700>)</span> -o <span style=color:#204a87;font-weight:700>$(</span>EXEC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>OBJS<span style=color:#204a87;font-weight:700>)</span>

<span style=color:#000>%.o</span><span style=color:#ce5c00;font-weight:700>:</span> %.<span style=color:#000>c</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>CFLAGS<span style=color:#204a87;font-weight:700>)</span> -c $&lt;

<span style=color:#000>clean</span><span style=color:#ce5c00;font-weight:700>:</span>
	rm -f <span style=color:#204a87;font-weight:700>$(</span>EXEC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>OBJS<span style=color:#204a87;font-weight:700>)</span>
</code></pre></div><p>The syntax here is tricky. The <code>%</code> symbols create a correspondence between the names of the object file and C file: any filename ending with <code>.o</code> depends on the same filename but with <code>.c</code> instead of <code>.o</code>. In the compilation command, <code>$&lt;</code> gets replaced with the name of the dependency, i.e. the name of the C file.</p><p>Let&rsquo;s check that this works, using <code>make clean</code> first to make sure it has to recompile everything:</p><pre><code>$ make clean
rm -f hypot hypot.o mathlib.o
$ ls
hypot.c  Makefile  mathlib.c  mathlib.h
$ make
clang -Wall -Wextra -Werror -Wpedantic -c hypot.c
clang -Wall -Wextra -Werror -Wpedantic -c mathlib.c
clang -lm -o hypot hypot.o mathlib.o
$ ls
hypot  hypot.c  hypot.o  Makefile  mathlib.c  mathlib.h  mathlib.o
</code></pre><p>And it does!</p><h4 id=formatting-with-clang-format>Formatting with clang-format</h4><p>If you use <a href=https://clang.llvm.org/docs/ClangFormat.html>clang-format</a> and have a configuration file (<code>.clang-format</code>) next to your code, you can add a target to run it with <code>make format</code> (here, the rest of the Makefile is omitted, since the target is not specific to our code):</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=color:#000>format</span><span style=color:#ce5c00;font-weight:700>:</span>
	clang-format -i -style<span style=color:#ce5c00;font-weight:700>=</span>file *.<span style=color:#ce5c00;font-weight:700>[</span>ch<span style=color:#ce5c00;font-weight:700>]</span>
</code></pre></div><h4 id=static-analysis-with-scan-build>Static analysis with scan-build</h4><p><a href=https://clang-analyzer.llvm.org/scan-build.html>scan-build</a> is a program that detects additional problems with your code at compile time (that a compiler normally would not). We can also call it with a Makefile target:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=color:#000>scan-build</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>clean</span>
	scan-build --use-cc<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> make
</code></pre></div><p>This target isn&rsquo;t as straightforward as the clang-format one. Some details to note are:</p><ul><li>scan-build&rsquo;s argument is the command that builds our program. Here, that is just <code>make</code>.</li><li>We list <code>clean</code> as a dependency. This ensures that all object files and executables are deleted before we run scan-build, so when scan-build runs <code>make</code>, the whole program is rebuilt.</li><li>scan-build sometimes overrides the compiler used by Make. We specify <code>--use-cc=$(CC)</code> (effectively <code>--use-cc=clang</code>) to make sure that it will run using the same compiler that we normally use (as opposed to, say, GCC).</li></ul><p>Here&rsquo;s an example of running it:</p><pre><code>$ make scan-build
rm -f hypot hypot.o mathlib.o
scan-build --use-cc=clang make
scan-build: Using '/usr/bin/clang-12' for static analysis
make[1]: warning: jobserver unavailable: using -j1.  Add '+' to parent make rule.
make[1]: Entering directory '/home/ben/code/c/ucsc-guide-hypot'
/usr/bin/../lib/clang/ccc-analyzer -Wall -Wextra -Werror -Wpedantic -c hypot.c
/usr/bin/../lib/clang/ccc-analyzer -Wall -Wextra -Werror -Wpedantic -c mathlib.c
/usr/bin/../lib/clang/ccc-analyzer -lm -o hypot hypot.o mathlib.o
make[1]: Leaving directory '/home/ben/code/c/ucsc-guide-hypot'
scan-build: Analysis run complete.
scan-build: Removing directory '/tmp/scan-build-2021-10-11-005941-146456-1' because it contains no reports.
scan-build: No bugs found.
</code></pre><h2 id=expanding-our-program>Expanding our program</h2><p>You&rsquo;ve now seen everything you need to know to use Makefiles. In this last section, I will demonstrate how the build process would change if you wanted to add more C files to your project. We&rsquo;re going to add one more C file and also have our Makefile compile a second binary in addition to <code>hypot</code>.</p><p>In the spirit of CSE 13S assignment 2, we&rsquo;ll build a test harness that compares the results of our <code>my_hypot</code> function with the standard library&rsquo;s <code>hypot</code>. The results should be identical, since we&rsquo;re also using the standard library&rsquo;s <code>sqrt</code> function and the calculation for what to take the square root of is trivial, but doing this will let us expand on our program.</p><p>Here&rsquo;s the code for the test harness. Save it in <code>hypot-test.c</code>:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=color:#8f5902;font-style:italic>// hypot-test.c
</span><span style=color:#8f5902;font-style:italic></span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;math.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&lt;stdio.h&gt;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#8f5902;font-style:italic>#include</span> <span style=color:#8f5902;font-style:italic>&#34;mathlib.h&#34;</span><span style=color:#8f5902;font-style:italic>
</span><span style=color:#8f5902;font-style:italic></span>
<span style=color:#204a87;font-weight:700>int</span> <span style=color:#000>main</span><span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>void</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
    <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>a</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1.0</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>a</span> <span style=color:#ce5c00;font-weight:700>&lt;=</span> <span style=color:#0000cf;font-weight:700>4.0</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>a</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#0000cf;font-weight:700>1.0</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
        <span style=color:#204a87;font-weight:700>for</span> <span style=color:#000;font-weight:700>(</span><span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>b</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#0000cf;font-weight:700>1.0</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>b</span> <span style=color:#ce5c00;font-weight:700>&lt;=</span> <span style=color:#0000cf;font-weight:700>4.0</span><span style=color:#000;font-weight:700>;</span> <span style=color:#000>b</span> <span style=color:#ce5c00;font-weight:700>+=</span> <span style=color:#0000cf;font-weight:700>1.0</span><span style=color:#000;font-weight:700>)</span> <span style=color:#000;font-weight:700>{</span>
            <span style=color:#204a87;font-weight:700>double</span> <span style=color:#000>hypot_result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>hypot</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>),</span> <span style=color:#000>my_hypot_result</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>my_hypot</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>),</span>
                   <span style=color:#000>difference</span> <span style=color:#ce5c00;font-weight:700>=</span> <span style=color:#000>fabs</span><span style=color:#000;font-weight:700>(</span><span style=color:#000>hypot_result</span> <span style=color:#ce5c00;font-weight:700>-</span> <span style=color:#000>my_hypot_result</span><span style=color:#000;font-weight:700>);</span>
            <span style=color:#000>printf</span><span style=color:#000;font-weight:700>(</span><span style=color:#4e9a06>&#34;a = %.0f, b = %.0f: hypot = %16.15lf, my_hypot = %16.15lf, diff &#34;</span>
                   <span style=color:#4e9a06>&#34;= %16.15lf</span><span style=color:#4e9a06>\n</span><span style=color:#4e9a06>&#34;</span><span style=color:#000;font-weight:700>,</span>
                   <span style=color:#000>a</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>b</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>hypot_result</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>my_hypot_result</span><span style=color:#000;font-weight:700>,</span> <span style=color:#000>difference</span><span style=color:#000;font-weight:700>);</span>
        <span style=color:#000;font-weight:700>}</span>
    <span style=color:#000;font-weight:700>}</span>
    <span style=color:#204a87;font-weight:700>return</span> <span style=color:#0000cf;font-weight:700>0</span><span style=color:#000;font-weight:700>;</span>
<span style=color:#000;font-weight:700>}</span>

</code></pre></div><p>We can compile it manually, making sure to link against the math library and our own <code>mathlib.o</code> (run <code>make</code> again if you don&rsquo;t have the object file):</p><pre><code>$ clang -Wall -Werror -Wextra -Wpedantic -c hypot-test.c
$ clang -lm -o hypot-test hypot-test.o mathlib.o
$ ./hypot-test
a = 1, b = 1: hypot = 1.414213562373095, my_hypot = 1.414213562373095, diff = 0.000000000000000
a = 1, b = 2: hypot = 2.236067977499790, my_hypot = 2.236067977499790, diff = 0.000000000000000
a = 1, b = 3: hypot = 3.162277660168380, my_hypot = 3.162277660168380, diff = 0.000000000000000
a = 1, b = 4: hypot = 4.123105625617661, my_hypot = 4.123105625617661, diff = 0.000000000000000
a = 2, b = 1: hypot = 2.236067977499790, my_hypot = 2.236067977499790, diff = 0.000000000000000
a = 2, b = 2: hypot = 2.828427124746190, my_hypot = 2.828427124746190, diff = 0.000000000000000
a = 2, b = 3: hypot = 3.605551275463989, my_hypot = 3.605551275463989, diff = 0.000000000000000
a = 2, b = 4: hypot = 4.472135954999580, my_hypot = 4.472135954999580, diff = 0.000000000000000
a = 3, b = 1: hypot = 3.162277660168380, my_hypot = 3.162277660168380, diff = 0.000000000000000
a = 3, b = 2: hypot = 3.605551275463989, my_hypot = 3.605551275463989, diff = 0.000000000000000
a = 3, b = 3: hypot = 4.242640687119285, my_hypot = 4.242640687119285, diff = 0.000000000000000
a = 3, b = 4: hypot = 5.000000000000000, my_hypot = 5.000000000000000, diff = 0.000000000000000
a = 4, b = 1: hypot = 4.123105625617661, my_hypot = 4.123105625617661, diff = 0.000000000000000
a = 4, b = 2: hypot = 4.472135954999580, my_hypot = 4.472135954999580, diff = 0.000000000000000
a = 4, b = 3: hypot = 5.000000000000000, my_hypot = 5.000000000000000, diff = 0.000000000000000
a = 4, b = 4: hypot = 5.656854249492381, my_hypot = 5.656854249492381, diff = 0.000000000000000
</code></pre><p>Next, let&rsquo;s modify our Makefile to automatically build <code>hypot-test</code>. First, we&rsquo;ll rename the existing <code>OBJS</code> to <code>HYPOT_OBJS</code>, since we&rsquo;ll eventually create a new list of object files that are needed for <code>hypot-test</code>. We&rsquo;ll also remove the <code>EXEC</code> variable and instead write <code>hypot</code> directly:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=color:#000>CC</span> <span style=color:#ce5c00;font-weight:700>=</span> clang
<span style=color:#000>CFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -Wall -Wextra -Werror -Wpedantic
<span style=color:#000>LDFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -lm
<span style=color:#000>HYPOT_OBJS</span> <span style=color:#ce5c00;font-weight:700>=</span> hypot.o mathlib.o

<span style=color:#000>all</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>hypot</span>

<span style=color:#000>hypot</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>$(</span><span style=color:#000>HYPOT_OBJS</span><span style=color:#204a87;font-weight:700>)</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>LDFLAGS<span style=color:#204a87;font-weight:700>)</span> -o hypot <span style=color:#204a87;font-weight:700>$(</span>HYPOT_OBJS<span style=color:#204a87;font-weight:700>)</span>

<span style=color:#000>%.o</span><span style=color:#ce5c00;font-weight:700>:</span> %.<span style=color:#000>c</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>CFLAGS<span style=color:#204a87;font-weight:700>)</span> -c $&lt;

<span style=color:#000>clean</span><span style=color:#ce5c00;font-weight:700>:</span>
	rm -f hypot <span style=color:#204a87;font-weight:700>$(</span>HYPOT_OBJS<span style=color:#204a87;font-weight:700>)</span>

<span style=color:#000>format</span><span style=color:#ce5c00;font-weight:700>:</span>
	clang-format -i -style<span style=color:#ce5c00;font-weight:700>=</span>file *.<span style=color:#ce5c00;font-weight:700>[</span>ch<span style=color:#ce5c00;font-weight:700>]</span>

<span style=color:#000>scan-build</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>clean</span>
	scan-build --use-cc<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> make
</code></pre></div><p>Now we can add <code>HYPOT_TEST_OBJS</code> with the object files that this program needs, as well as a <code>hypot-test</code> target. We&rsquo;ll also add <code>hypot-test</code> as a dependency of the <code>all</code> target, so that running <code>make</code> with no arguments builds both <code>hypot</code> and <code>hypot-test</code>. And finally, we&rsquo;ll add the executable and object files to our <code>clean</code> target:</p><div class=highlight><pre style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-makefile data-lang=makefile><span style=color:#000>CC</span> <span style=color:#ce5c00;font-weight:700>=</span> clang
<span style=color:#000>CFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -Wall -Wextra -Werror -Wpedantic
<span style=color:#000>LDFLAGS</span> <span style=color:#ce5c00;font-weight:700>=</span> -lm
<span style=color:#000>HYPOT_OBJS</span> <span style=color:#ce5c00;font-weight:700>=</span> hypot.o mathlib.o
<span style=color:#000>HYPOT_TEST_OBJS</span> <span style=color:#ce5c00;font-weight:700>=</span> hypot-test.o mathlib.o

<span style=color:#000>all</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>hypot</span> <span style=color:#000>hypot</span>-<span style=color:#000>test</span>

<span style=color:#000>hypot</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>$(</span><span style=color:#000>HYPOT_OBJS</span><span style=color:#204a87;font-weight:700>)</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>LDFLAGS<span style=color:#204a87;font-weight:700>)</span> -o hypot <span style=color:#204a87;font-weight:700>$(</span>HYPOT_OBJS<span style=color:#204a87;font-weight:700>)</span>

<span style=color:#000>hypot-test</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#204a87;font-weight:700>$(</span><span style=color:#000>HYPOT_TEST_OBJS</span><span style=color:#204a87;font-weight:700>)</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>LDFLAGS<span style=color:#204a87;font-weight:700>)</span> -o hypot-test <span style=color:#204a87;font-weight:700>$(</span>HYPOT_TEST_OBJS<span style=color:#204a87;font-weight:700>)</span>

<span style=color:#000>%.o</span><span style=color:#ce5c00;font-weight:700>:</span> %.<span style=color:#000>c</span>
	<span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>CFLAGS<span style=color:#204a87;font-weight:700>)</span> -c $&lt;

<span style=color:#000>clean</span><span style=color:#ce5c00;font-weight:700>:</span>
	rm -f hypot hypot-test <span style=color:#204a87;font-weight:700>$(</span>HYPOT_OBJS<span style=color:#204a87;font-weight:700>)</span> <span style=color:#204a87;font-weight:700>$(</span>HYPOT_TEST_OBJS<span style=color:#204a87;font-weight:700>)</span>

<span style=color:#000>format</span><span style=color:#ce5c00;font-weight:700>:</span>
	clang-format -i -style<span style=color:#ce5c00;font-weight:700>=</span>file *.<span style=color:#ce5c00;font-weight:700>[</span>ch<span style=color:#ce5c00;font-weight:700>]</span>

<span style=color:#000>scan-build</span><span style=color:#ce5c00;font-weight:700>:</span> <span style=color:#000>clean</span>
	scan-build --use-cc<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#204a87;font-weight:700>$(</span>CC<span style=color:#204a87;font-weight:700>)</span> make
</code></pre></div><p>Let&rsquo;s test this out by running <code>make clean</code> and then having it recompile everything with <code>make</code>:</p><pre><code>$ ls
hypot    hypot.o     hypot-test.c  Makefile   mathlib.h
hypot.c  hypot-test  hypot-test.o  mathlib.c  mathlib.o
$ make clean
rm -f hypot hypot-test hypot.o mathlib.o hypot-test.o mathlib.o
$ ls
hypot.c  hypot-test.c  Makefile  mathlib.c  mathlib.h
$ make
clang -Wall -Wextra -Werror -Wpedantic -c hypot.c
clang -Wall -Wextra -Werror -Wpedantic -c mathlib.c
clang -Wall -Wextra -Werror -Wpedantic -c hypot-test.c
clang -lm -o hypot hypot.o mathlib.o
clang -lm -o hypot-test hypot-test.o mathlib.o
$ ls
hypot    hypot.o     hypot-test.c  Makefile   mathlib.h
hypot.c  hypot-test  hypot-test.o  mathlib.c  mathlib.o
$ ./hypot
side a: 3
side b: 4
c = 5.000000
$ ./hypot-test
a = 1, b = 1: hypot = 1.414213562373095, my_hypot = 1.414213562373095, diff = 0.000000000000000
a = 1, b = 2: hypot = 2.236067977499790, my_hypot = 2.236067977499790, diff = 0.000000000000000
a = 1, b = 3: hypot = 3.162277660168380, my_hypot = 3.162277660168380, diff = 0.000000000000000
a = 1, b = 4: hypot = 4.123105625617661, my_hypot = 4.123105625617661, diff = 0.000000000000000
a = 2, b = 1: hypot = 2.236067977499790, my_hypot = 2.236067977499790, diff = 0.000000000000000
a = 2, b = 2: hypot = 2.828427124746190, my_hypot = 2.828427124746190, diff = 0.000000000000000
a = 2, b = 3: hypot = 3.605551275463989, my_hypot = 3.605551275463989, diff = 0.000000000000000
a = 2, b = 4: hypot = 4.472135954999580, my_hypot = 4.472135954999580, diff = 0.000000000000000
a = 3, b = 1: hypot = 3.162277660168380, my_hypot = 3.162277660168380, diff = 0.000000000000000
a = 3, b = 2: hypot = 3.605551275463989, my_hypot = 3.605551275463989, diff = 0.000000000000000
a = 3, b = 3: hypot = 4.242640687119285, my_hypot = 4.242640687119285, diff = 0.000000000000000
a = 3, b = 4: hypot = 5.000000000000000, my_hypot = 5.000000000000000, diff = 0.000000000000000
a = 4, b = 1: hypot = 4.123105625617661, my_hypot = 4.123105625617661, diff = 0.000000000000000
a = 4, b = 2: hypot = 4.472135954999580, my_hypot = 4.472135954999580, diff = 0.000000000000000
a = 4, b = 3: hypot = 5.000000000000000, my_hypot = 5.000000000000000, diff = 0.000000000000000
a = 4, b = 4: hypot = 5.656854249492381, my_hypot = 5.656854249492381, diff = 0.000000000000000
</code></pre><p>It all worked! Make handles building multiple binaries very well—notice how it only built <code>mathlib.c</code> once, even though it is needed by both binaries. Also, this Makefile compiles both binaries by default (thanks to the <code>all</code> target), but you can also compile only one binary with <code>make hypot</code> or <code>make hypot-test</code>.</p></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/hamorrar/ucsc-guide aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2021 Hilal Morrar, et al. All Rights Reserved</small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/mermaid@8.11.2/dist/mermaid.min.js integrity=sha384-m8Pdaep6Qk8sW3J6XhPOiwUww3maU9HxZTLvEfSEB4e1UVvTdHyfJsYmEfYqvwLC crossorigin=anonymous></script><style>.markmap>svg{width:100%;height:300px}</style><script>window.markmap={autoLoader:{manual:!0}}</script><script src=https://cdn.jsdelivr.net/npm/markmap-autoloader></script><script src=/ucsc-guide/js/tabpane-persist.js></script><script src=/ucsc-guide/js/deflate.js></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.css integrity=sha384-Cqd8ihRLum0CCg8rz0hYKPoLZ3uw+gES2rXQXycqnL5pgVQIflxAUDS7ZSjITLb5 crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/katex.min.js integrity=sha384-1Or6BdeNQb0ezrmtGeqQHFpppNd7a/gw29xeiSikBbsb44xu3uAo8c7FwbF5jhbd crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/contrib/mhchem.min.js integrity=sha384-LIgAiYlGSAdpNC9+YDjDPF6JeS/RRIumtNo0CmyQERZ/+g0h9MbuYQwf/5pQ4Y4M crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.2/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload='renderMathInElement(document.body,{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"},{display:!0,left:"\\[",right:"\\\\]"}],errorcolor:"#CD5C5C",throwonerror:!1})'></script><script src=/ucsc-guide/js/main.min.c1b8f3c373b85f900699a7ea81c2038ebbbebcac1a5a4b6e5ef96c24c31790d6.js integrity="sha256-wbjzw3O4X5AGmafqgcIDjru+vKwaWktuXvlsJMMXkNY=" crossorigin=anonymous></script></body></html>